import serial
import time
from crc import x25crc

import sys

def GetFramContents():
    led_error_btn.configure(background="green")
    received_text.delete("1.0", "end")
    ComPort = com_port.get()
    if ComPort == '':
        ComPort = "COM4"
    com_port.delete(0, "end")
    com_port.insert(1, ComPort.upper())
    BaudRate = 9600
    num_records = 2
    if checkbox_all.get():
        num_records = 64

    root.update()

    if checkbox_compare.get():
        filename = askopenfile(mode ='r', filetypes =[('Calibration Files', '*.dat')])
        if filename is None:
            checkbox_compare.set(False)
    """
    0 b'\xfe\x14\x00\x01\x023\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00C\xf3'
    1 b'\xfe\x14\x00\x01\x023\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00/\xc4'
    2 b'\xfe\x14\x00\x01\x023\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x9b\x9d'
    3 b'\xfe\x14\x00\x01\x023\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf7\xaa'
    4 b'\xfe\x14\x00\x01\x023\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf3.'
    5 b'\xfe\x14\x00\x01\x023\x05\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x9f\x19'
    6 b'\xfe\x14\x00\x01\x023\x06\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00+@'
    7 b'\xfe\x14\x00\x01\x023\x07\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00Gw'
    8 b'\xfe\x14\x00\x01\x023\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x002@'
    9 b'\xfe\x14\x00\x01\x023\t\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00^w'
    10 b'\xfe\x14\x00\x01\x023\n\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xea.'
    11 b'\xfe\x14\x00\x01\x023\x0b\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x86\x19'
    12 b'\xfe\x14\x00\x01\x023\x0c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x82\x9d'
    13 b'\xfe\x14\x00\x01\x023\r\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xee\xaa'
    14 b'\xfe\x14\x00\x01\x023\x0e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00Z\xf3'
    15 b'\xfe\x14\x00\x01\x023\x0f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x006\xc4'
    16 b'\xfe\x14\x00\x01\x023\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb0\x9d'
    17 b'\xfe\x14\x00\x01\x023\x11\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xdc\xaa'
    18 b'\xfe\x14\x00\x01\x023\x12\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00h\xf3'
    19 b'\xfe\x14\x00\x01\x023\x13\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04\xc4'
    20 b'\xfe\x14\x00\x01\x023\x14\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00@'
    21 b'\xfe\x14\x00\x01\x023\x15\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00lw'
    22 b'\xfe\x14\x00\x01\x023\x16\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd8.'
    23 b'\xfe\x14\x00\x01\x023\x17\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb4\x19'
    24 b'\xfe\x14\x00\x01\x023\x18\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc1.'
    25 b'\xfe\x14\x00\x01\x023\x19\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xad\x19'
    26 b'\xfe\x14\x00\x01\x023\x1a\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x19@'
    27 b'\xfe\x14\x00\x01\x023\x1b\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00uw'
    28 b'\xfe\x14\x00\x01\x023\x1c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00q\xf3'
    29 b'\xfe\x14\x00\x01\x023\x1d\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x1d\xc4'
    30 b'\xfe\x14\x00\x01\x023\x1e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xa9\x9d'
    31 b'\xfe\x14\x00\x01\x023\x1f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc5\xaa'
    32 b'\xfe\x14\x00\x01\x023 \x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xa5.'
    33 b'\xfe\x14\x00\x01\x023!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc9\x19'
    34 b'\xfe\x14\x00\x01\x023"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00}@'
    35 b'\xfe\x14\x00\x01\x023#\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x11w'
    36 b'\xfe\x14\x00\x01\x023$\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x15\xf3'
    37 b'\xfe\x14\x00\x01\x023%\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00y\xc4'
    38 b'\xfe\x14\x00\x01\x023&\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcd\x9d'
    39 b"\xfe\x14\x00\x01\x023'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xa1\xaa"
    40 b'\xfe\x14\x00\x01\x023(\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd4\x9d'
    41 b'\xfe\x14\x00\x01\x023)\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb8\xaa'
    42 b'\xfe\x14\x00\x01\x023*\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0c\xf3'
    43 b'\xfe\x14\x00\x01\x023+\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00`\xc4'
    44 b'\xfe\x14\x00\x01\x023,\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00d@'
    45 b'\xfe\x14\x00\x01\x023-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08w'
    46 b'\xfe\x14\x00\x01\x023.\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbc.'
    47 b'\xfe\x14\x00\x01\x023/\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd0\x19'
    48 b'\xfe\x14\x00\x01\x0230\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00V@'
    49 b'\xfe\x14\x00\x01\x0231\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00:w'
    50 b'\xfe\x14\x00\x01\x0232\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x8e.'
    51 b'\xfe\x14\x00\x01\x0233\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xe2\x19'
    52 b'\xfe\x14\x00\x01\x0234\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xe6\x9d'
    53 b'\xfe\x14\x00\x01\x0235\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x8a\xaa'
    54 b'\xfe\x14\x00\x01\x0236\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00>\xf3'
    55 b'\xfe\x14\x00\x01\x0237\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00R\xc4'
    56 b"\xfe\x14\x00\x01\x0238\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'\xf3"
    57 b'\xfe\x14\x00\x01\x0239\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00K\xc4'
    58 b'\xfe\x14\x00\x01\x023:\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\x9d'
    50 b'\xfe\x14\x00\x01\x023;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x93\xaa'
    60 b'\xfe\x14\x00\x01\x023<\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x97.'
    61 b'\xfe\x14\x00\x01\x023=\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xfb\x19'
    62 b'\xfe\x14\x00\x01\x023>\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00O@'
    63 b'\xfe\x14\x00\x01\x023?\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00#w'
    64 b'\xfe\x14\x00\x01\x023@\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x9e@'
    65 b'\xfe\x14\x00\x01\x023A\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf2w'
    66 b'\xfe\x14\x00\x01\x023B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00F.'
    for command address 0
    cmd_template = b'\xfe\x14\x00\x01\x02\x33\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
    cmd_template[6] = address
    crc = x25crc(cmd_template[1:])
    crc_extra = 74
    crc.accumulate_str(struct.pack('B', crc_extra))
    my_crc = crc.crc
    print(hex(my_crc)        
    """
    cmd_list = [
        b'\xfe\x14\x00\x01\x023\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00C\xf3',
        b'\xfe\x14\x00\x01\x023\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00/\xc4',
        b'\xfe\x14\x00\x01\x023\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x9b\x9d',
        b'\xfe\x14\x00\x01\x023\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf7\xaa',
        b'\xfe\x14\x00\x01\x023\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf3.',
        b'\xfe\x14\x00\x01\x023\x05\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x9f\x19',
        b'\xfe\x14\x00\x01\x023\x06\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00+@',
        b'\xfe\x14\x00\x01\x023\x07\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00Gw',
        b'\xfe\x14\x00\x01\x023\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x002@',
        b'\xfe\x14\x00\x01\x023\t\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00^w',
        b'\xfe\x14\x00\x01\x023\n\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xea.',
        b'\xfe\x14\x00\x01\x023\x0b\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x86\x19',
        b'\xfe\x14\x00\x01\x023\x0c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x82\x9d',
        b'\xfe\x14\x00\x01\x023\r\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xee\xaa',
        b'\xfe\x14\x00\x01\x023\x0e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00Z\xf3',
        b'\xfe\x14\x00\x01\x023\x0f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x006\xc4',
        b'\xfe\x14\x00\x01\x023\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb0\x9d',
        b'\xfe\x14\x00\x01\x023\x11\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xdc\xaa',
        b'\xfe\x14\x00\x01\x023\x12\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00h\xf3',
        b'\xfe\x14\x00\x01\x023\x13\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04\xc4',
        b'\xfe\x14\x00\x01\x023\x14\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00@',
        b'\xfe\x14\x00\x01\x023\x15\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00lw',
        b'\xfe\x14\x00\x01\x023\x16\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd8.',
        b'\xfe\x14\x00\x01\x023\x17\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb4\x19',
        b'\xfe\x14\x00\x01\x023\x18\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc1.',
        b'\xfe\x14\x00\x01\x023\x19\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xad\x19',
        b'\xfe\x14\x00\x01\x023\x1a\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x19@',
        b'\xfe\x14\x00\x01\x023\x1b\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00uw',
        b'\xfe\x14\x00\x01\x023\x1c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00q\xf3',
        b'\xfe\x14\x00\x01\x023\x1d\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x1d\xc4',
        b'\xfe\x14\x00\x01\x023\x1e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xa9\x9d',
        b'\xfe\x14\x00\x01\x023\x1f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc5\xaa',
        b'\xfe\x14\x00\x01\x023 \x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xa5.',
        b'\xfe\x14\x00\x01\x023!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc9\x19',
        b'\xfe\x14\x00\x01\x023"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00}@',
        b'\xfe\x14\x00\x01\x023#\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x11w',
        b'\xfe\x14\x00\x01\x023$\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x15\xf3',
        b'\xfe\x14\x00\x01\x023%\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00y\xc4',
        b'\xfe\x14\x00\x01\x023&\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcd\x9d',
        b"\xfe\x14\x00\x01\x023'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xa1\xaa",
        b'\xfe\x14\x00\x01\x023(\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd4\x9d',
        b'\xfe\x14\x00\x01\x023)\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb8\xaa',
        b'\xfe\x14\x00\x01\x023*\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0c\xf3',
        b'\xfe\x14\x00\x01\x023+\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00`\xc4',
        b'\xfe\x14\x00\x01\x023,\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00d@',
        b'\xfe\x14\x00\x01\x023-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08w',
        b'\xfe\x14\x00\x01\x023.\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbc.',
        b'\xfe\x14\x00\x01\x023/\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd0\x19',
        b'\xfe\x14\x00\x01\x0230\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00V@',
        b'\xfe\x14\x00\x01\x0231\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00:w',
        b'\xfe\x14\x00\x01\x0232\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x8e.',
        b'\xfe\x14\x00\x01\x0233\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xe2\x19',
        b'\xfe\x14\x00\x01\x0234\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xe6\x9d',
        b'\xfe\x14\x00\x01\x0235\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x8a\xaa',
        b'\xfe\x14\x00\x01\x0236\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00>\xf3',
        b'\xfe\x14\x00\x01\x0237\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00R\xc4',
        b"\xfe\x14\x00\x01\x0238\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'\xf3",
        b'\xfe\x14\x00\x01\x0239\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00K\xc4',
        b'\xfe\x14\x00\x01\x023:\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\x9d',
        b'\xfe\x14\x00\x01\x023;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x93\xaa',
        b'\xfe\x14\x00\x01\x023<\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x97.',
        b'\xfe\x14\x00\x01\x023=\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xfb\x19',
        b'\xfe\x14\x00\x01\x023>\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00O@',
        b'\xfe\x14\x00\x01\x023?\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00#w'
        b'\xfe\x14\x00\x01\x023@\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x9e@',
        b'\xfe\x14\x00\x01\x023A\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf2w',
        b'\xfe\x14\x00\x01\x023B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00F.',
    ]
    ser = serial.Serial(ComPort, BaudRate)
    ser.timeout = 5
    ser.reset_input_buffer()

    if checkbox_compare.get():
        file = open(filename.name, "rb")

    error_lines = 0
    for i in range(0, num_records):
        command = cmd_list[i]
        ser.write(command)
        s = ser.read(28)
        hex_string = "".join("%02X " % b for b in s)
        hex_string = str(hex_string)
        if i == 0:
            printable_string = "{: <2}: {}\t{}\n".format(i, hex_string[30:-7],str(s[10:-2], 'utf-8'))
            received_text.insert("end", printable_string)
        elif i == 1:
            printable_string = "{: <2}: {}\t{}\n".format(i, hex_string[30:-7],str(s[11:-4], 'utf-8'))
            received_text.insert("end", printable_string)
        else:
            printable_string = "{: <2}: {}\n".format(i, hex_string[30:-7])
            received_text.insert("end", printable_string)

        if checkbox_compare.get():
            data = list(file.read(16))
            file_string = "".join("%02X " % x for x in data)
            file_string = file_string.strip()
            fram_string = "{}".format(hex_string[30:-7])
            fram_string = fram_string.strip()

            if fram_string != file_string:
                error_lines = error_lines + 1
                received_text.insert("end", "    " + file_string + " (dat)" + '\n')
                received_text.focus()
                received_text.tag_config("start", foreground="red")
                rowCol_start = "{}.0".format(i + 1 + error_lines)
                rowCol_end = "{}.57".format(i + 1 + error_lines)
                received_text.tag_add("start", rowCol_start, rowCol_end)
                led_error_btn.configure(background="red")
        root.update()
        ser.reset_input_buffer()
    ser.close()
    if checkbox_compare.get():
        filename.close()
        file.close()


if __name__ == '__main__':
    import tkinter
    import tkinter.scrolledtext as tkst
    from tkinter.filedialog import askopenfile

    root = tkinter.Tk()
    root.title("Honeywell ULF Read FRAM via Teensy")
    screen_width = root.winfo_screenwidth()
    screen_height = root.winfo_screenheight()
    window_width = 650
    window_height = 500
    x_cordinate = int((screen_width/2) - (window_width/2))
    y_cordinate = int((screen_height/2) - (window_height/2))
    window_geometry = "{}x{}+{}+{}".format(window_width, window_height, x_cordinate, y_cordinate)
    root.geometry(window_geometry)
    root['bg'] = 'white'

    start_button = tkinter.Button(root, text="Read Fram", command=GetFramContents)
    start_button.place(x=50, y=40)

    port = tkinter.StringVar()
    com_port = tkinter.Entry(root, textvariable=port, justify='center', state='normal')
    com_port.place(x=130, y=40)

    received_text = tkst.ScrolledText(root, height=23, width=70)
    received_text.place(x=35, y=90)
    received_text.configure(state='normal')

    checkbox_all = tkinter.IntVar()
    checkbox_all_btn = tkinter.Checkbutton(root,  text="Check for all", variable=checkbox_all)
    checkbox_all_btn.place(x=280, y=40)

    checkbox_compare = tkinter.IntVar()
    checkbox_compare_btn = tkinter.Checkbutton(root,  text="Compare DAT", variable=checkbox_compare)
    checkbox_compare_btn.place(x=410, y=40)

    led_error_btn = tkinter.Button(root, text="Error", background="green", fg="white", width=4, state="normal")
    led_error_btn.place(x=530, y=40)
    root.mainloop()

